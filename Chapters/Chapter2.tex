%!TEX root = ../tcc.tex

\chapter{Napster, Gnutella, eDonkey e BitTorrent}

Para entendermos como e por que o BitTorrent se tornou o que é hoje, devemos voltar um
pouco no tempo e rever a história que precedeu à sua criação, que é no fim da década dos
anos 1990.

\section{Período pré-torrent}

Entre o final dos anos 80 e o início dos 90 \cite{wiki:fs,wiki:fs-timeline}, a
Internet deixou de ser uma rede de computadores usada somente por entidades
governamentais, laboratórios de pesquisa e universidades, passando a ter seu acesso
comercializado para o público em geral pelos \glspl{isp} \cite{wiki:isp}. Com o
advento do \gls{mp3} \cite{wiki:mp3}, no final de 1991, e do seu primeiro reprodutor
de áudio \gls*{mp3} Winamp, o tráfego da Internet cresceu devido ao aumento da troca
direta desse tipo de arquivo.

Entre 1998 e 1999, dois sites de compartilhamento gratuito de músicas foram criados: o
MP3.com \cite{wiki:mp3.com}, que era um site de divulgação de bandas independentes,
e o \gls{audiogalaxy} \cite{wiki:audiogalaxy.com,revista:pnp}. Mais popular que o
primeiro, o \gls*{audiogalaxy} era um site de busca de músicas, sendo que o download e
upload eram feitos a partir de um software cliente. A lista de músicas procuradas era
enviada pelo site para o computador onde o usuário tinha instalado o cliente, que então
conectava com o computador do outro usuário, que era indicado pelo servidor. A lista
possuía todos os arquivos que um dia passaram pela sua rede. Se algum arquivo fosse
requisitado, mas o usuário que o possuísse não estivesse conectado, o servidor central
do \gls*{audiogalaxy} fazia a ponte, pegando o arquivo para si e enviando-o para o
cliente do requisitante em seu próximo login.

O período dos 3 anos seguintes à criação desses dois sites foi muito produtivo ao
mundo das \glspl{p2p} de modo geral, onde surgiram alguns protocolos desse paradigma e
inúmeros softwares que os implementavam. Os mais relevantes foram o Napster, o Gnutella,
o eDonkey e o BitTorrent.

\subsection{Napster}

Em maio de 1999 surgiu o Napster \cite{wiki:napster}, um programa de
compartilhamento de \gls*{mp3} que inovou por desfigurar o usual modelo
cliente-servidor, onde um servidor central localizava os arquivos nos usuários e fazia
a conexão entre os usuários, onde ocorria a transferências. O Napster foi contemporâneo
do \gls*{audiogalaxy} e ambos fizeram muito sucesso por cerca de 2 anos, até que
começaram as ações judiciais.

Não demorou muito tempo para a indústria da música entrar em ação contra a troca de
arquivos protegidos por direitos autorais sem autorização pela Internet. Seu primeiro
alvo foi o Napster, em dezembro de 1999, quando a \gls{riaa} entrou com processo
representando várias gravadoras alegando quebra de direitos autorais
\cite{site:napster-riaa}. Em abril de 2000, foi a vez da banda Metallica processar,
como resposta à sua descoberto que uma música ainda não lançada oficialmente já
circulava na rede \cite{site:napster-metallica,site:napster-metallica-orig}. Um mês
depois, outra ação, agora encabeçada pelo rapper Dr. Dre, que tinha feito pedido formal
para a retirada de seu material de circular, também abriu processo
\cite{site:napster-drdre-orig}. Isso fez com que o Napster tivesse atenção da mídia,
ganhando popularidade e atingindo o 20 milhões de usuários em meados de 2000
\cite{site:napster-use-2000}.

Em 2001, esses imbróglios judiciais resultaram numa liminar federal que ordenava a
retirada de conteúdo protegido das entidades representadas pela \gls*{riaa}. O Napster
tentou, mas a juíza do caso não ficou satisfeita ordenando então, em julho, o
desligamento da rede enquanto não conseguisse controlar o conteúdo que trafegava ali
\cite{wiki:napster}. Em setembro, o Napster fez um acordo, onde pagou 26 milhões de
dólares por danos já causados, uso indevido de música e também 10 milhões de dólares
pelos danos futuros envolvendo royalties. Para pagar esse valor, o Napster tentou cobrar
o serviço de seus usuários, que acabaram migrando de rede \gls*{p2p}, inclusive para o
\gls*{audiogalaxy}. Não conseguindo, em 2002, o Napster decreta falência e é forçado a
liquidar seus ativos. De lá para cá, foi negociado algumas vezes e atualmente pertence
ao site Rhapsody \cite{site:napster-rhapsody}.

O sucesso do Napster, mesmo que por curto período tempo, mostrou o potencial das redes
\gls*{p2p} poderiam ter, e com isso novos softwares e protocolos de redes foram sendo
lançados, sempre tentando se diferenciar dos outros softwares a fim de não serem novos
alvos de ações judiciais. A solução para isso foi tentar descentralizar os mecanismos de
indexação e de busca, que foram os pontos fracos do Napster.

\subsection{Gnutella}

O tal sucessor foi o \gls{gnutella}, em março de 2000 \cite{wiki:gnutella}, foi uma
resposta de domínio público feita com ``gambiarras'' para os problemas que o Napster
encontrou com relação ás acusações deviolação de direitos autorais. Enquanto o Napster
possuía um servidor central como estrutura que, no julgamento, foi usado como prova de
que o sistema encorajava a violação de direitos autorais, o \gls*{gnutella} foi modelado
como um sistema \gls*{p2p} puro, onde todos os \glspl*{peer} são completamente iguais,
sendo responsáveis pelos seus próprios atos.

O \gls*{gnutella} disponibiliza arquivos da mesma forma que o Napster
\cite{book:birman}, mas sem a limitação de ser de formato de música, ou seja, qualquer
arquivo pode ser compartilhado. A diferença mais significativa entre os dois protocolos
é o algoritmo de busca: a abordagem do \gls*{gnutella} é baseada numa forma de
\gls{anycast}. Isso envolve duas partes: a primeira é como cada usuário é conectado a
outros nós e mantém a lista dessas conexões atualizada. A segunda parte é como ele
trata as buscas e trabalha inundando de pedidos para todos os nós que estão a uma certa
distância do usuário (nó-cliente). Por exemplo, se a distância limite for de 4, então
todos os nós que estiverem a 4 passos a partir do cliente serão verificados, começando
a partir dos mais próximos. Eventualmente, algum nó possuirá o arquivo requisitado e
responderá, e assim será feita a transferência desse arquivo. Muitos softwares que
implementam o protocolo vão além dessa funcionalidade básica de download simples
tentando transferir de forma paralela partes diferentes do arquivo desejado de nós
diferentes, tentando amenizar eventuais problemas de velocidade de rede.

Experiências sugerem assim que o sistema escala para um tamanho maior, o mecanismo de
\gls*{anycast} se torna extremamente caro e em algumas vezes até proibitivo. O problema
ocorre nas buscas por arquivos menos populares, onde será necessário um maior número de
nós perguntados.

O \gls*{gnutella} ainda teve uma segunda versão \cite{wiki:gnutella2}, no final de 2002,
onde utilizou o mesmo protocolo que o original, porém organizando a rede de
\glspl*{peer} em \emph{leafs} (folhas, em inglês) e \emph{hubs}. Um \emph{hub} poderia
ter centenas de conexões de folhas outras 7, em média, a outros \emph{hubs}, enquanto
uma folha se conectaria apenas a 2 \emph{hubs}. Essa nova topologia, somada com uma
nova tabela de índice de arquivos das folhas mantida pelos \emph{hubs} onde estavam
conectados, melhorou o desempenho das buscas, que era ruim na versão antiga.

\subsection{eDonkey}

O protocolo \gls{edonkey} inovou em muitos aspectos de seus precursores, tendo papel
fundamental na história das redes \gls*{p2p} e sua consolidação como ferramenta de
compartilhamento especializado em arquivos grandes.

O \gls*{edonkey} implementou o primeiro método de download por \gls{swarming}, que é
chamado o método onde \glspl*{peer} fazem downloads de diferentes partes de um arquivo e
de \glspl*{peer} diferentes, utilizando de forma efetiva a largura de banda de rede
para todos os \glspl*{peer} ao invés de ficar limitado somente à banda de um único
\gls*{peer}.

Outra melhoria foi a busca: no seu lançamento, os servidores eram separados entre si,
porém nas versões seguintes permitiu que eles formassem uma rede de buscas. Isso
permitiu que os servidores repassassem buscas de seus clientes conectados localmente a
outros servidores, facilitando a localização de \glspl*{peer} conectados em qualquer
servidor da rede de buscas, aumentando a capacidade de download do enxame.

Uma terceira diferença com o Napster foi o uso de \glspl{hashvalue} de arquivos
nos resultados de busca ao invés dos simples nomes dos arquivos. As buscas geradas
pelos usuários eram baseadas em palavras-chave e comparadas com a lista de nomes de
arquivos armazenada no servidor, mas o servidor retornava uma lista de pares de nomes
de arquivos com seus repectivos valores \gls*{hashvalue}. Enfim, quando o usuário
selecionasse o arquivo desejado, o cliente iniciaria o download do arquivo usando o seu
valor \gls*{hashvalue}. Desse modo, um arquivo poderia ter muitos nomes entre os
diferentes \gls*{peer} e servidores, mas seria considerado idêntico para download se
possuísse o mesmo \gls*{hashvalue}.

A arquitetura da rede em dois níveis usando cliente e servidor alcançou um meio termo
entre as redes centralizadas, como o Napster, e as descentralizadas, como o
\gls*{gnutella}, já que o servidor central no primeiro era um alvo estável para ações
legais, enquanto o segundo rapidamente mostrou-se inviável devido ao tráfego massivo de
buscas entre \glspl*{peer}.

Por fim, a inovação mais importante foi o uso de \glspl{dht}, em específico o
\gls{kademlia}, como algoritmo de indexação e busca nos servidores centrais dos
arquivos através da rede \gls*{edonkey}. Além de ser uma das causas da melhora no
desempenho nas buscas, \glspl*{dht} possuem ainda outras características como
tolerância a falhas e escalabilidade. O \gls*{kademlia} ainda oferece
outras vantagens como armazenamento de dados eficiente; anonimato; segurança de rede,
conteúdo e usuário; e autenticação.

\section{Nascimento do BitTorrent}

Em meados dos anos 90, Bram Cohen era um programador que tinha largado a faculdade no
segundo ano do curso de Ciência da Computação da Universidade de Buffalo, Nova Iorque,
para trabalhar em empresas \emph{pontocom}. A última delas foi a MojoNation, uma
empresa que desenvolvia um software de distribuição de arquivos criptografados por
\gls*{swarming}, que ele já tinha percebido ser uma vantagem com relação ao Kazaa, que
fazia transferências de uma única origem.

Em abril de 2001, Bram saiu da MojoNation e começou a modelar o protocolo BitTorrent,
lançando a primeira implementação em Python em julho de 2001. Em fevereiro de 2002, ele
apresentou o seu trabalho na CodeCon \cite{site:codecon} e na mesma época começou a
testá-lo, usando uma coleção de material pornográfico para atrair \glspl{betatester}
\cite{site:bramcohen}. O software começou a ser usado imediatamente pelos usuários.

Nesse meio tempo, Bram ainda passou pela Valve \cite{wiki:bramcohen}, empresa de
desenvolvimento de jogos, para trabalhar no sistema de distribuição online do jogo
Half Life 2. Em 2004, saiu da Valve e voltou o foco ao Torrent. Em setembro, fundou a
BitTorrent Inc. com seu irmão Ross Cohen e o parceiro de negócios Ashwin Navin,
sendo então responsável pelo desenvolvimento do protocolo. Nesse mesmo ano, o
BitTorrent passou a ser bastante utilizado, quando surgiram os primeiros programas de
televisão e filmes compartilhados pelo protocolo.

Já em maio de 2005, Cohen lança uma nova versão do BitTorrent que não precisa de
\glspl{tracker}, juntamente com um site de buscas de conteúdo na Internet. Em setembro,
a empresa recebe do investidor David Chao \$8.5 milhões de dólares. No final desse ano,
a BitTorrent Inc. e a MCAA \cite{wiki:mcaa} fizeram um acordo que a empresa de ajudar os
usuário a encontrar conteúdos não autorizado dos representados da associação, que não
ajudou no combate a pirataria pois já havia outros sites de busca nessa época, como o
TorrentSpy, Mininova, NewNova e o The Pirate Bay.

\section{Mundo pós-torrent}

Desde o fechamento do site de buscas, a BitTorrent Inc. tem desenvolvido outros
softwares baseados na tecnologia \gls*{p2p} \cite{site:bittorrent}, como transmissão de
vídeos ao vivo (BitTorrent Live), sincronização de arquivos entre computadores ligados
à Internet (BitTorrent Sync), publicação e distribuição de conteúdo de artistas a seus
fãs (BitTorrent Bundles), entre outros serviços comerciais.

Como protocolo, o BitTorrent criou um novo paradigma de transmissão de informação pela
Internet, sendo utilizado de inúmeras formas e motivos.

\begin{itemize}
    \item alguns softwares de podcasting, como o Miro \cite{site:miro}, passaram a
        usar o protocolo como forma de lidar com a grande quantidade de downloads de
        programas online;

    \item o site da gravadora DGM Live fornece o conteúdo via torrent após a venda
        \cite{site:dgm};

    \item VODO \cite{site:vodo} é um site de divulgação e distribuição de filmes sob a
        licença Creative Commons e que faz a publicação em outros sites de buscas de
        torrent;

    \item canais como a americana CBC \cite{site:cbc} e a holandesa VPRO
        \cite{site:vpro} já disponibilizaram programas de sua programação para
        download. A norueguesa NRK o faz para conteúdos em HD \cite{site:nrk} e,
        apesar de algumas restrições de direitos, tem aumentado a oferta;

    \item o serviço da Amazon Web Services de armazenamento de conteúdo via web service,
        a Amazon S3, permite o uso de torrent para a transmissão de arquivos
        \cite{site:aws-s3};

    \item as empresas de desenvolvimento de jogos CCP Games, produtora do jogo Eve
        Online, usa o protocolo para distribuir o instalador de seu jogo
        \cite{site:eve}. A Blizzard, dona de Diablo III, StarCraft II e World of
        Warcraft, distribui esses jogos e ainda suas eventuais atualizações
        \cite{site:blizzard};

    \item o governo britânico distribuiu os detalhes de seus gastos \cite{site:gov-uk},
        enquanto a Universidade do Estado da Flórida usa para transmitir grandes
        conjuntos de dados científicos para seus pesquisadores \cite{site:univ-fl};

    \item Facebook \cite{site:facebook-torrent} e Twitter \cite{site:twitter-torrent}
        usam para transmitir o código atualizado de seus sites para seus servidores de
        aplicação de forma eficiente \cite{site:twitter-torrent-power}.
\end{itemize}

Em 2013, o BitTorrent é um dos maiores geradores de tráfego de rede do mundo, ao lado
do NetFlix, Youtube, Facebook e acessos HTTP \cite{report:internet-usage-2013}, e segue
em uma tendência de aumento.

\subsection{Questões legais}

Desde que surgiu, o BitTorrent, bem como os outros protocolos, chamou atenção dos
defensores de direitos autorais e acabou sendo alvo de medidas judiciais. Porém, assim
como o \gls*{gnutella} e ao contrário do Napster, por possuir uma estrutura
descentralizada e não armazenar dados sob direitos, dificulta o trabalho de se
identificar usuários desses dados.

Ainda assim, não existe um consenso sobre os efeitos financeiros do compartilhamento de
arquivos protegidos por direitos autorais, onde o principal argumento utilizado pelos
reclamantes é que estes têm fortes prejuízos e, por isso, entram com ações
indenizatórias de grandes valores. Existem alguns estudos que tentam medir esse
prejuízo; um dos mais recentes \cite{report:lse-piracy} mostrou que não existem
evidências de diminuição das receitas das empresas cujo conteúdo é pirateado e que o
combate contra os usuários infringentes não tem o impacto esperado, que é de reduzir o
compartilhamento.

\subsection{Estudos acadêmicos}

\todoquestion{tá beeem resumido; desenvolve mais??}

Academicamente, o protocolo é bastante estudado desde o seu surgimento, onde são
focados efeitos do algoritmo original e alguns estudos de ajuste fino de seu
funcionamento. Os pontos principais são o algoritmo do jogo da troca de pedaços,
estudos das topologias das redes formadas pelos \glspl*{peer} e melhorias de eficiência
com alterações nessas topologias.

\afterpage{\clearpage}