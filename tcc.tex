%% -------------------------------------------------------------------------------------
%% tcc.tex -- MAIN FILE
%% -------------------------------------------------------------------------------------
\documentclass[a4paper, 12pt, oneside, brazil]{book}

%% -------------------------------------------------------------------------------------
%% PACKAGES
%% -------------------------------------------------------------------------------------

\usepackage[brazil]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

% Cor
\usepackage[table,dvipsnames]{xcolor}

% Links azuis
\usepackage[unicode,colorlinks=true,linkcolor=blue]{hyperref}

% Usa estilo "Natbib" para as referências bibliográficas
\usepackage[backend=biber,bibencoding=utf8,style=numeric-comp]{biblatex}

% \makeglossaries
% http://en.wikibooks.org/wiki/LaTeX/Glossary#Using_defined_terms
\usepackage[xindy,toc]{glossaries}

% http://texblog.org/tag/addcontentsline/
\usepackage[numbib]{tocbibind}

% \newminted{cpp}
% [chapter] é para numerar usando o capítulo
\usepackage[chapter]{minted}

% anotações TODO
\usepackage[colorinlistoftodos,portuguese]{todonotes}

\usepackage{csquotes}      % requerido por {babel}
\usepackage{graphicx}      % \includegraphics
\usepackage{caption}       % \begin{caption}
\usepackage{subcaption}    % \begin{subfigure}
\usepackage{verbatim}      % \begin{comment}
\usepackage{fullpage}      % margens menores
\usepackage{indentfirst}   % indentação dos 1ºs parágrafos
\usepackage{setspace}      % \setstretch
\usepackage{afterpage}     % \afterpage http://tex.stackexchange.com/q/88657

% Desligando a ligatura do 'fi'
% http://www.latex-community.org/forum/viewtopic.php?f=5&t=953#p13896
\usepackage{microtype}
\DisableLigatures{encoding = *, family = *}

% padding de imagens
%\setlength\fboxsep{2mm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Links só nos primeiros usos de gls etc
% http://tex.stackexchange.com/a/109137/5125
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \usepackage{etoolbox}
% \makeatletter
%% patch first occurence of
%% "\@gls@link[#1]{#2}{\@glo@text}", as
%% this is the one for \glsused{#2}
%\patchcmd{\@gls@}
%  {\@gls@link[#1]{#2}{\@glo@text}}
%  {\@gls@link[#1,hyper=false]{#2}{\@glo@text}}
%  {}{}
%
%\patchcmd{\@Gls@}
%  {\@gls@link[#1]{#2}}
%  {\@gls@link[#1,hyper=false]{#2}}
%  {}{}
%
%\patchcmd{\@GLS@}
%  {\@gls@link[#1]{#2}{\MakeUppercase{\@glo@text}}}
%  {\@gls@link[#1,hyper=false]{#2}{\MakeUppercase{\@glo@text}}}
%  {}{}
%\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% -------------------------------------------------------------------------------------
%% CONFIGURATIONS
%% -------------------------------------------------------------------------------------

%%%%%%%%%%%%%%%%%%%%%
%  ???
%%%%%%%%%%%%%%%%%%%%%
% from http://tex.stackexchange.com/q/57151
%\usepackage{accsupp}
%\newcommand{\emptyaccsupp}[1]{\BeginAccSupp{ActualText={}}#1\EndAccSupp{}}

\addbibresource{bibliografia.bib}

\loadglsentries{glossario.tex}
\makeglossaries

\includeonly{
    Chapters/Chapter1,     % 1. Introdução
    Chapters/Chapter2,     % 2. Histórico
    Chapters/Chapter3,     % 3. Anatomia
    Chapters/Chapter4,     % 4. Parte técnica
    Chapters/Chapter5,     % 5. Conclusão
    Chapters/Chapter6,     % 6. Referências
    Chapters/Chapter7,     % 7. Parte Subjetiva
}

\hypersetup{
     colorlinks   = true,
     citecolor    = Sepia
}

% Fonte 'Times' do sistema (mais bonita)
% http://www.tug.org/pracjourn/2006-1/schmidt/schmidt.pdf
\renewcommand{\rmdefault}{ptm}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Do manual do todonote
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\todorefs}[1]{
    \todo[
        color=Orchid,
        bordercolor=Plum,
        inline
    ]{#1}
}

\newcommand{\todoquestion}[1]{
    \todo[
        color=LimeGreen,
        bordercolor=OliveGreen,
        inline
    ]{#1}
}

\newcommand{\todoerrors}[1]{
    \todo[
        color=BrickRed,
        bordercolor=BrickRed,
        inline
    ]{#1}
}

\newcommand{\todoimg}[1]{
    \missingfigure{#1}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Seta pasta de figuras
\graphicspath{{Figures/}{Figures/multiple/}}

%%%%%%%%%%%%%%%%%%%%%
%  Minted
%%%%%%%%%%%%%%%%%%%%%

% Do manual do minted
\renewcommand\listingscaption{Código fonte}
\renewcommand\listoflistingscaption{Lista de códigos fonte}

% http://tex.stackexchange.com/a/99656/5125
\renewcommand{\listoflistings}{%
    \cleardoublepage
    \addcontentsline{toc}{chapter}{\listoflistingscaption}%
    \listof{listing}{\listoflistingscaption}%
}

% usando valores predefinidos
% \begin{cppcode}
% template <typename T>
%   T id(T value) {
%     return value;
%   }
% \end{cppcode}
%
%
% sobrescrevendo valores
% \begin{cppcode*} {linenos=false,frame=single}
% template <typename T>
%   T id(T value) {
%     return value;
%   }
% \end{cppcode*}
%
% labels: http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.169.9130&rep=rep1&type=pdf
\newminted{cpp}{
    linenos,
    frame=single,
    samepage=true,
    gobble=2,
    numbersep=6pt,
    baselinestretch=1,
    fontfamily=courier,
    fontsize=\footnotesize
}


%% -------------------------------------------------------------------------------------
%% DOCUMENT
%% -------------------------------------------------------------------------------------

\begin{document}

\thispagestyle{empty}

% Numeração das primeiras páginas em números romanos
\frontmatter

% OBS:
% \clearpage vs \newpage
% http://tex.stackexchange.com/q/45609
%
% \afterpage{\clearpage}
% http://tex.stackexchange.com/q/88657


%%%%%%%%%%%%%%%%%%%%%
%  Capa
%  https://www.sharelatex.com/blog/2013/08/09/thesis-series-pt5.html
%%%%%%%%%%%%%%%%%%%%%
\begin{titlepage}
    \begin{center}
        \addcontentsline{toc}{chapter}{Capa}
        \vspace*{1cm}

        \Huge
        \textbf{Anatomia do BitTorrent}

        \vspace{0.5cm}
        \LARGE
        a Ciência da Computação por trás do protocolo

        \vspace{2.5cm}

        \textbf{
            Paulo Cheadi Haddad Filho \\
            Orientador: José Coelho de Pina
        }

        \vfill

        Trabalho de Conclusão de Curso

        \vspace{3.5cm}

        \includegraphics[scale=0.1]{logo-ime.png}

        \vspace{2cm}

        \Large
        %Instituto de Matemática e Estatística\\
        Universidade de São Paulo\\
        São Paulo, 2013

    \end{center}
    \afterpage{\clearpage}

\end{titlepage}

% Melhor ter fonte menor e espaçamento de linha maior
\setstretch{1.3}



%%%%%%%%%%%%%%%%%%%%%
% Páginas frontais
%%%%%%%%%%%%%%%%%%%%%

% Sumário
\tableofcontents

% Lista de códigos fonte
\listoflistings

% Lista de figuras
\listoffigures

% Glossário
% \glsaddall
\printglossary[type=main,style=altlist]

% Lista de TODOs
\listoftodos
\todototoc

% Lista de abreviações, se precisar
\begin{comment}
    % Tabelas mais fáceis de ler
    \setstretch{1.5}

    % Nova página
    \afterpage{\clearpage}

    % Lista de abreviações (2 colunas)
    \listofsymbols{ll} {
    % \textbf{Acronym} & \textbf{W}hat (it) \textbf{S}tands \textbf{F}or \\
    % \textbf{LAH} & \textbf{L}ist \textbf{A}bbreviations \textbf{H}ere \\
    }

    % Volta pro 1.3
    \setstretch{1.3}
\end{comment}

\afterpage{\clearpage}



%%%%%%%%%%%%%%%%%%%%%
% Conteúdo
%%%%%%%%%%%%%%%%%%%%%

% Pula uma linha entre parágrafos
\addtolength{\parskip}{\baselineskip}

% Numeração normal em indo-arábico
\mainmatter

% Inclusões dos capítulos
\include{Chapters/Chapter1} % Introdução

\include{Chapters/Chapter2} % Histórico

\include{Chapters/Chapter3} % Anatomia

\include{Chapters/Chapter4} % Parte técnica

\include{Chapters/Chapter5} % Conclusão

\include{Chapters/Chapter6} % Referências

\include{Chapters/Chapter7} % Parte Subjetiva

% Espaço no ToC, por estética
% \addtocontents{toc}{\vspace{2em}}

\end{document}